<article class="post-template {{ .Params.topic }}">

  {{- if .Scratch.Get "featuredPost" }}
  <div class="featured"><i class="fad fa-rocket-launch" style="--fa-secondary-opacity: 0.60"></i>Featured Post</div>
  {{- end }}

  {{- if .Params.shouldMoveFeatureImage }}
  <div class="feature-image" style="background-image: url('{{ .Params.featureImage }}')">
    <img src="{{ .Params.featureImage }}" alt="{{ .Title }}">
  </div>
  {{- end }}

  <header class="post-header{{ if .Params.shouldMoveFeatureImage }} feature-overlay{{ end }}">
    <div class="title-byline">
      {{- $mood := .Params.mood | default "default" }}
      {{- with .Params.authors }}
        {{- range first 1 . }}
          {{- $author := $.GetPage (printf `/authors/%s` (. | urlize)) }}
          <img src="{{ index $author.Params.avatars $mood }}">
        {{- end }}
      {{- end }}
      <div>
        <h1><a href="{{ .Permalink }}">{{ .Title }}</a></h1>
        <small>
          {{- with .Params.authors }}
          <i class="fad fa-user{{ if gt (len .) 1 }}-friends{{ end }}" style="--fa-secondary-opacity: 0.70"></i>
          <ul>
            {{ range . }}
            {{- $author := $.GetPage (printf `/authors/%s` (. | urlize)) }}
            <li><a href="{{ $author.Permalink }}">{{ $author.Title }}</a></li>
            {{ end }}
          </ul>
          {{- end }}
          <i class="fad fa-calendar" style="--fa-secondary-opacity: 0.70"></i> {{ .Date | time.Format ":date_medium" }}
          {{ $reactionsTotal := add 0
            (int .Params.reactions.thumbsUp)
            (int .Params.reactions.laugh)
            (int .Params.reactions.wow)
            (int .Params.reactions.sad)
          }}
          {{ if gt $reactionsTotal 0 }}
          <span class="reactions">
            <i class="fas fa-grin"></i>
            <span class="total">{{ string $reactionsTotal }}</span>
            <ul class="tooltip">
              {{- with .Params.reactions.thumbsUp }}
              <li class="thumbs-up"><i class="fad fa-thumbs-up"></i>{{ . }}</li>
              {{- end }}
              {{- with .Params.reactions.laugh }}
              <li class="laugh"><i class="fas fa-laugh-squint"></i>{{ . }}</li>
              {{- end }}
              {{- with .Params.reactions.wow }}
              <li class="wow"><i class="fas fa-surprise"></i>{{ . }}</li>
              {{- end }}
              {{- with .Params.reactions.sad }}
              <li class="sad"><i class="fas fa-sad-tear"></i>{{ . }}</li>
              {{- end }}
            </ul>
          </span>
          {{- end }}
        </small>
      </div>
    </div>
  </header>

  <div class="post-body">
    {{- $content := .Content }}
    {{- if .Params.pullUpFeatureImage }}
      {{- $content = replaceRE "(<(p|div)[^>]*?>)?\\s*?(<a[^>]*?>)?\\s*?<img[^>]*?>\\s*?(</a>)?\\s*?(</(?:p|div)>)?((<br[^>]*?>)?\\s*?)*" "" .Content 1 }}
    {{- end }}
    {{ $content }}
  </div>

  <footer class="post-footer">
    {{- $tags := .GetTerms "tags" }}
    {{- with $tags}}
    <span class="tag-icon"><i class="fas fa-tag{{ if gt $tags 1 }}s{{ end }}"></i></span>
    {{- end }}
    <ul>
      {{- range $tags }}
      <li><a href="{{ .Permalink }}">{{ .LinkTitle }}</a></li>
      {{- end }}
    </ul>
    <span class="top-icon"><i class="fas fa-arrow-alt-up"></i></span>
  </footer>

</article>
